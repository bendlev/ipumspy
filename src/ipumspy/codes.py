# This file is part of ipumspy.
# For copyright and licensing information, see the NOTICE and LICENSE files
# in this project's top-level directory, and also on-line at:
#   https://github.com/ipums/ipumspy

# pylint: disable=too-few-public-methods
"""
Codes for IPUMS data
"""


class RelateCode:
    """ Codes for RELATE field in IPUMS """

    HEAD_OF_HOUSEHOLD = 1
    SPOUSE = 2
    CHILD = 3
    CHILD_IN_LAW = 4
    PARENT = 5
    PARENT_IN_LAW = 6
    SIBLING = 7
    SIBLING_IN_LAW = 8
    GRANDCHILD = 9
    OTHER_RELATIVE = 10
    PARTNER_FRIEND_VISITOR = 11
    OTHER_NON_RELATIVE = 12
    INMATE = 13


class RelatedCode:
    """ Codes for the RELATED field in IPUMS """

    HEAD_OF_HOUSEHOLD = 101

    SPOUSE = 201
    SECOND_SPOUSE = 202

    CHILD = 301
    ADOPTED_CHILD = 302
    STEP_CHILD = 303
    ADOPTED_CHILD_NS = 304

    CHILD_IN_LAW = 401
    STEP_CHILD_IN_LAW = 402

    PARENT = 501
    STEP_PARENT = 502

    PARENT_IN_LAW = 601
    STEP_PARENT_IN_LAW = 602

    SIBLING = 701
    STEP_HALF_ADOPTED_SIBLING = 702

    SIBLING_IN_LAW = 801
    STEP_HALF_ADOPTED_SIBLING_IN_LAW = 802

    GRANDCHILD = 901
    ADOPTED_GRANDCHILD = 902
    STEP_GRANDCHILD = 903
    ADOPTED_GRANDCHILD_NS = 904

    OTHER_RELATIVE_PLACEHOLDER = 1000
    OTHER_RELATIVE = 1001

    GRANDPARENT = 1011
    STEP_GRANDPARENT = 1012
    GRANDPARENT_IN_LAW = 1013

    AUNT_OR_UNCLE = 1021
    AUNT_OR_UNCLE_IN_LAW = 1022

    NIECE_OR_NEPHEW = 1031
    NIECE_OR_NEPHEW_IN_LAW = 1032
    STEP_OR_ADOPTED_NIECE_OR_NEPHEW = 1033
    GRAND_NIECE_OR_NEPHEW = 1034

    COUSIN = 1041
    COUSIN_IN_LAW = 1042
    GREAT_GRANDCHILD = 1051

    # TODO(khw): What does "NEC" mean?
    OTHER_RELATIVE_NEC = 1061

    # NON-RELATIVES
    PARTNER_FRIEND_VISITOR_CATEGORY = 1100
    PARTNER_FRIEND_CATEGORY = 1110
    FRIEND = 1111
    PARTNER = 1112
    PARTNER_ROOMMATE = 1113
    UNMARRIED_PARTNER = 1114
    HOUSEMATE_ROOMMATE = 1115

    RELATIVE_OF_PARTNER = 1120

    CONCUBINE_OR_MISTRESS = 1130
    VISITOR = 1131
    COMPANION_AND_FAMILY_OF_COMPANION = 1132
    ALLOCATED_PARTNER_FRIEND_OR_VISITOR = 1139

    # FROM HERE UNTIL 1240, this is the pre-1940 system
    OTHER_NON_RELATIVE_PRE_1940_CATEGORY = 1200
    ROOMER_BOARDER_OR_LODGER = 1201
    BOARDER = 1202
    LODGER = 1203
    ROOMER = 1204
    TENANT = 1205
    FOSTER_CHILD = 1206

    DOMESTIC_EMPLOYEE_CATEGORY = 1210
    SERVANT = 1211
    HOUSEKEEPER = 1212
    MAID = 1213
    COOK = 1214
    NURSE = 1215
    OTHER_PROBABLE_DOMESTIC_EMPLOYEE = 1216
    OTHER_EMPLOYEE = 1217
    RELATIVE_OF_DOMESTIC_EMPLOYEE = 1219

    MILITARY = 1221
    STUDENTS = 1222
    MEMBERS_OF_RELIGIOUS_ORDERS = 1223

    OTHER_NON_RELATIVE = 1230
    ALLOCATED_OTHER_NON_RELATIVE = 1239

    # POST 1940 System for all below
    LODGER_OR_FOSTER_CHILD_CATEGORY = 1240
    LODGER_OTHER = 1241
    FOSTER_CHILD_OTHER = 1242

    EMPLOYEE_CATEGORY = 1250
    DOMESTIC_EMPLOYEE = 1251
    NON_DOMESTIC_EMPLOYEE = 1252
    RELATIVE_OF_STAFF = 1253

    OTHER_NON_RELATIVE_CATEGORY_1990 = 1260

    OTHER_NON_INMATE_1990 = 1270

    GQ_HEAD = 1281
    GQ_STAFF = 1282
    GQ_RELATIVE_OF_STAFF = 1283
    OTHER_NON_INMATE_1940_1959 = 1284

    OLD_GQ_CATEGORIES = 1290
    MILITARY_OLD = 1291
    COLLEGE_DORMITORY_OLD = 1292
    ROOMING_HOUSE_RESIDENT_OLD = 1293
    OTHER_NON_INMATE_1980 = 1294
    OTHER_NON_INMATE_1960_1970 = 1295
    INSTITUTION_NON_INMATE = 1296

    INSTITUTION_INMATE = 1301

    UNCLASSIFIABLE = 9996
    UNKNOWN = 9997
    ILLEGIBLE = 9998
    MISSING = 9999

    @classmethod
    def lookup(cls, code: int) -> str:
        """
        Look up a code and return its description

        Raises:
            KeyError: code is not found
        """
        for key, value in cls.__dict__.items():
            if value == code:
                return key
        raise KeyError(f"code {code} not found")


class SexCode:
    """ Codes for the SEX IPUMS variable """

    MALE = 1
    FEMALE = 2
